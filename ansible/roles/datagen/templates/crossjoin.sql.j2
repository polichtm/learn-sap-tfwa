CREATE GLOBAL TEMPORARY TABLE XA (a int, b int) ON COMMIT PRESERVE ROWS;
do begin declare I,K INT; declare S,T NVARCHAR(10); declare SQLSTR NVARCHAR(100); R10 = (select 0 as XNUM from SYS.DUMMY union all select 1 as XNUM from SYS.DUMMY union all select 2 as XNUM from SYS.DUMMY union all select 3 as XNUM from SYS.DUMMY union all select 4 as XNUM from SYS.DUMMY union all select 5 as XNUM from SYS.DUMMY union all select 6 as XNUM from SYS.DUMMY union all select 7 as XNUM from SYS.DUMMY union all select 8 as XNUM from SYS.DUMMY union all select 9 as XNUM from SYS.DUMMY); R10000000 = (select row_number() over () as XNUM from :R10 as R1 cross join :R10 as R2 cross join :R10 as R3 cross join :R10 as R4 cross join :R10 as R5 cross join :R10 as R6 cross join :R10 as R7); INSERT INTO XA (select A.XNUM as A, 100 as B from :R10000000 A ); FOR K IN 1..{{ num_schemas }} DO S='DATAGEN_'||:K; SQLSTR='CREATE SCHEMA '||:S; EXEC :SQLSTR; FOR I IN 1..{{ num_tables_per_schema }} DO T='CROSS_'||:I; SQLSTR='CREATE COLUMN TABLE '||:S||'.'||:T||' (a int, b int) PARTITION BY HASH ("A") PARTITIONS 100'; EXEC :SQLSTR; SQLSTR='INSERT INTO '||:S||'.'||:T||' (A,B) SELECT A,B FROM XA'; EXEC :SQLSTR; END FOR; END FOR; end;
TRUNCATE TABLE XA;
DROP TABLE XA;
